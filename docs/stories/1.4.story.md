# Story 1.4: Dashboard & Read Views

**Epic**: WNDMNGR Modernization
**Status**: Draft
**Points**: 5

## Story Statement
**As a** User,
**I want** to browse all farms in a sidebar and view their details in organized tabs (General, Referents, Services, etc.),
**so that** I can access the same information as the old Streamlit app but within the new Taipy interface.

## Context & Background
Now that the Data Layer and Auth are ready, we need to rebuild the main UI. Taipy uses a different paradigm (Pages and View Models). We will replicate the Sidebar navigation and the Tabbed interface. We will also implement the "Send Email" feature for contacts.

## Acceptance Criteria
1.  **Sidebar**:
    *   Lists all farms sorted by Code.
    *   Search/Filter input to quickly find a farm.
    *   Selecting a farm updates the main view.
2.  **Tabs**: The following tabs are implemented (Read-Only):
    *   **General Information**: Displays SPV, Project, Code, Type.
    *   **Referents**: Displays contacts with a "Send Email" button (`mailto:` link).
    *   **Services**: Displays associated companies.
    *   **Contracts & Admin**: Displays admin details (Status, Contracts, etc.).
    *   **Location**: Displays geographic info.
    *   **Technical**: Displays basic technical stats (if available).
3.  **UI Layout**:
    *   Responsive layout.
    *   Clean typography.
    *   "Send Email" button opens default mail client.

## Technical Details

### Architecture Alignment
*   **Tech Stack**: Taipy GUI.
*   **File Structure**:
    *   `src/pages/dashboard.py`: Main dashboard page logic.
    *   `src/pages/dashboard.md`: Taipy Markdown template (or inline `tgb`).
    *   `src/components/`: Reusable widgets (e.g., `contact_card`).

### Taipy Specifics
*   **Navigation**: Use a `selector` in the sidebar bound to `selected_farm_uuid`.
*   **Tabs**: Use `part` blocks or Taipy's `toggle` / `navbar` to simulate tabs if standard tabs aren't flexible enough, or use `<|layout|>` columns.
*   **State**: Bind UI elements to `state.current_farm_data`.
*   **"Send Email"**: Use a generic Markdown link `[Send Email](mailto:...)` or a button with a callback that uses `webbrowser` (if running locally) or `navigate()` to a mailto URL.

## Tasks
1.  [ ] Create `src/pages/dashboard.py` and register it in `app.py`.
2.  [ ] Implement Sidebar:
    *   Load `farms_list` from `database.get_all_farms()`.
    *   Create a `selector` widget.
    *   On change, trigger `on_farm_selected` callback to load full farm data.
3.  [ ] Implement **General Info** View:
    *   Bind to `current_farm_data['general_info']`.
4.  [ ] Implement **Referents** View:
    *   Loop through roles/persons.
    *   Create "Contact Cards" with Name, Role, and Email Button.
5.  [ ] Implement **Services** View.
6.  [ ] Implement **Contracts** View.
7.  [ ] Implement **Location** View.
8.  [ ] Verify "Send Email" works (opens mail client).

## Testing Requirements
*   **Manual Test**: Launch app. Click different farms in sidebar. Verify data changes. Check "Send Email" button.
